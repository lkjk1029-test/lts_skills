# 웹 애플리케이션 취약점 체크리스트

이 문서는 웹 보안 분석기 스킬에서 사용하는 취약점 점검 항목들을 정의한다.

## 1. 인증 및 접근 제어

### 1.1 로그인 프로세스
- [ ] **로그인 폼 보안**
  - [ ] 비밀번호 필드가 mask 처리되어 있는가
  - [ ] 자동 로그인 옵션에 안전한 만료 시간이 설정되어 있는가
  - [ ] 로그인 실패 시 오류 메시지가 정보를 노출하지 않는가
  - [ ] CAPTCHA 또는 봇 방지 조치가 있는가

- [ ] **세션 관리**
  - [ ] 로그아웃 시 세션이 완전히 삭제되는가
  - [ ] 유휴 시간 초과 후 자동 로그아웃되는가
  - [ ] 세션 ID가 예측 불가능한가
  - [ ] 동시 로그인 제한이 있는가

### 1.2 접근 제어
- [ ] **인가 확인**
  - [ ] 인증 없이 접근 가능한 관리자 페이지가 있는가
  - [ ] URL 직접 입력으로 접근 제어를 우회할 수 있는가
  - [ ] 권한 없는 사용자가 다른 사용자 정보에 접근할 수 있는가
  - [ ] 파일 다운로드 시 권한 확인이 있는가

## 2. 입력 검증 및 XSS

### 2.1 입력값 검증
- [ ] **파라미터 조작**
  - [ ] URL 파라미터 조작으로 비정상 동작이 가능한가
  - [ ] 폼 필드 값 변경으로 권한을 우회할 수 있는가
  - [ ] 숨겨진 필드 값 조작이 가능한가
  - [ ] AJAX 요청 파라미터 조작이 가능한가

- [ ] **SQL 인젝션**
  - [ ] 입력값에 특수문자(' " ; -- 등) 처리가 있는가
  - [ ] 에러 메시지에 DB 구조 정보가 노출되는가
  - [ ] Prepared Statement 또는 Parameterized Query를 사용하는가

### 2.2 XSS (Cross-Site Scripting)
- [ ] **반사형 XSS**
  - [ ] URL 파라미터에 스크립트 삽입이 가능한가
  - [ ] 검색 결과나 에러 메시지에 입력값이 그대로 출력되는가
  - [ ] 입력값 출력 시 HTML escaping이 되는가

- [ ] **저장형 XSS**
  - [ ] 게시글, 댓글 등에 스크립트 저장이 가능한가
  - [ ] 프로필 정보나 사용자 입력 데이터에 스크립트 저장이 가능한가
  - [ ] Content Security Policy (CSP)가 설정되어 있는가

## 3. HTTP 보안

### 3.1 HTTPS 설정
- [ ] **SSL/TLS**
  - [ ] 전체 사이트가 HTTPS로 운영되는가
  - [ ] HTTP 접근 시 HTTPS로 리다이렉트되는가
  - [ ] 만료된 SSL 인증서나 weak cipher가 사용되는가
  - [ ] HSTS (HTTP Strict Transport Security)가 설정되어 있는가

- [ ] **Mixed Content**
  - [ ] HTTPS 페이지에서 HTTP 리소스를 로드하는가
  - [ ] HTTP 이미지, 스크립트, CSS가 있는가
  - [ ] HTTP AJAX 요청이 있는가

### 3.2 보안 헤더
- [ ] **기본 보안 헤더**
  - [ ] X-Frame-Options (Clickjacking 방지) 설정
  - [ ] X-XSS-Protection 설정
  - [ ] X-Content-Type-Options: nosniff 설정
  - [ ] Referrer-Policy 설정

- [ ] **CSP (Content Security Policy)**
  - [ ] CSP 헤더가 설정되어 있는가
  - [ ] Inline 스크립트 실행이 제한되는가
  - [ ] unsafe-inline, unsafe-eval이 사용되는가
  - [ ] 외부 도메인 화이트리스트가 적절한가

## 4. 쿠키 및 세션 보안

### 4.1 쿠키 보안
- [ ] **쿠키 속성**
  - [ ] Secure 속성이 설정되어 있는가 (HTTPS 전용)
  - [ ] HttpOnly 속성이 설정되어 있는가 (JavaScript 접근 방지)
  - [ ] SameSite 속성이 적절하게 설정되어 있는가
  - [ ] 쿠키 만료 시간이 합리적인가

- [ ] **세션 쿠키**
  - [ ] 세션 ID가 예측 가능하지 않은가
  - [ ] 세션 쿠키에 민감정보가 포함되지 않는가
  - [ ] 로그아웃 시 세션 쿠키가 삭제되는가

## 5. 정보 노출

### 5.1 오류 처리
- [ ] **에러 메시지**
  - [ ] 상세한 에러 메시지가 시스템 정보를 노출하는가
  - [ ] DB 에러나 스택 트레이스가 사용자에게 표시되는가
  - [ ] 파일 경로나 내부 구조가 노출되는가
  - [ ] 커스텀 에러 페이지가 있는가

### 5.2 디렉토리 및 파일 노출
- [ ] **디렉토리 리스팅**
  - [ ] 디렉토리 접근 시 파일 목록이 표시되는가
  - [ ] 백업 파일(.bak, .old)이 접근 가능한가
  - [ ] 설정 파일이나 로그 파일에 접근 가능한가
  - [ ] .git, .svn 등 버전 관리 파일에 접근 가능한가

### 5.3 주석 및 메타데이터
- [ ] **HTML 주석**
  - [ ] HTML 소스에 민감한 주석이 포함되어 있는가
  - [ ] API 키나 내부 경로가 주석에 노출되는가
  - [ ] 개발 관련 정보가 주석에 포함되어 있는가

- [ ] **메타데이터**
  - [ ] 서버 정보(Software, Version)가 노출되는가
  - [ ] 개발 도구나 프레임워크 정보가 노출되는가
  - [ ] 개발자 정보가 노출되는가

## 6. 클라이언트 측 보안

### 6.1 JavaScript 보안
- [ ] **민감정보 처리**
  - [ ] API 키나 비밀번호가 JavaScript에 하드코딩되어 있는가
  - [ ] 비즈니스 로직이 클라이언트에 노출되어 있는가
  - [ ] 민감 데이터가 localStorage/sessionStorage에 저장되는가
  - [ ] 클라이언트 측 암호화가 필요한 데이터가 있는가

- [ ] **코드 보안**
  - [ ] 난독화되지 않은 상용 코드가 포함되어 있는가
  - [ ] 디버깅 정보나 console.log가 제거되지 않았는가
  - [ ] 사용되지 않는 라이브러리나 의존성이 있는가

### 6.2 로컬 스토리지
- [ ] **데이터 저장**
  - [ ] 민감정보가 localStorage에 저장되는가
  - [ ] 세션 정보가 sessionStorage에 저장되는가
  - [ ] 저장된 데이터에 만료 시간 설정이 있는가
  - [ ] 클라이언트에서 데이터 삭제가 가능한가

## 7. API 보안

### 7.1 엔드포인트 보안
- [ ] **API 접근 제어**
  - [ ] API 엔드포인트에 인증이 필요한가
  - [ ] 인증 토큰이 안전하게 전송되는가
  - [ ] API 키가 URL이나 로그에 노출되는가
  - [ ] Rate Limiting이 설정되어 있는가

- [ ] **데이터 검증**
  - [ ] API 입력값 검증이 있는가
  - [ ] SQL 인젝션이나 XSS에 방어가 되는가
  - [ ] 불필요한 정보를 API 응답에 포함하지 않는가

### 7.2 CORS (Cross-Origin Resource Sharing)
- [ ] **CORS 정책**
  - [ ] CORS 정책이 너무 관대하게 설정되어 있는가
  - [ ] 신뢰할 수 없는 도메인에서 요청을 허용하는가
  - [ ] 자격증명(credential) 포함 요청이 제한되는가
  - [ ] preflight 요청이 적절히 처리되는가

## 8. 파일 업로드 보안

### 8.1 파일 검증
- [ ] **파일 타입 검사**
  - [ ] 파일 확장자 필터링이 있는가
  - [ ] MIME 타입 검증이 있는가
  - [ ] 파일 내용 기반 검증이 있는가
  - [ ] 실행 가능 파일 업로드가 차단되는가

- [ ] **파일 크기 및 개수**
  - [ ] 파일 크기 제한이 있는가
  - [ ] 동시 업로드 개수 제한이 있는가
  - [ ] 디스크 공간 부족 공격에 방어가 되는가

### 8.2 저장소 보안
- [ ] **저장 위치**
  - [ ] 업로드 파일이 웹 루트 외부에 저장되는가
  - [ ] 파일 이름이 예측 불가능하게 변경되는가
  - [ ] 업로드 디렉토리에 실행 권한이 없는가
  - [ ] 악성 스크립트 실행이 방지되는가

## 9. 비즈니스 로직 취약점

### 9.1 권한 상승
- [ ] **수직 권한 상승**
  - [ ] 일반 사용자가 관리자 기능에 접근할 수 있는가
  - [ ] 파라미터 조작으로 권한을 변경할 수 있는가
  - [ ] 역할 기반 접근 제어가 있는가

- [ ] **수평 권한 상승**
  - [ ] 다른 사용자의 정보에 접근할 수 있는가
  - [ ] ID/PK 조작으로 데이터 접근이 가능한가
  - [ ] 사용자 간 데이터 격리가 되는가

### 9.2 비즈니스 규칙 우회
- [ ] **프로세스 우회**
  - [ ] 결제 프로세스를 우회할 수 있는가
  - [ ] 승인 단계를 건너뛸 수 있는가
  - [ ] 제한 횟수를 초과하여 작업을 수행할 수 있는가
  - [ ] 시간 제약을 우회할 수 있는가

## 10. 서버 측 보안

### 10.1 서버 설정
- [ ] **서버 정보**
  - [ ] 서버 소프트웨어 정보가 노출되는가
  - [ ] 기본 설정이 그대로 사용되고 있는가
  - [ ] 불필요한 서비스가 실행되고 있는가
  - [ ] 최신 보안 패치가 적용되었는가

### 10.2 백업 및 복구
- [ ] **백업 보안**
  - [ ] 백업 파일에 접근 제한이 있는가
  - [ ] 백업 데이터가 암호화되어 있는가
  - [ ] 백업 주기와 보관 정책이 적절한가
  - [ ] 복구 절차가 문서화되어 있는가

## 위험도 평가 기준

### 높음 (High)
- 즉각적인 조치가 필요한 심각한 취약점
- 원격 코드 실행, 권한 상승 등
- 민감정보 대량 노출 가능성

### 중간 (Medium)
- 조정이 필요한 중요 취약점
- 제한적인 권한 상승, 정보 노출
- 사회공학과 결합 시 위험 가능성

### 낮음 (Low)
- 개선이 권장되는 사항
- 정보 노출 가능성은 낮으나 보안 강화 필요
- 우회가 어려운 논리적 취약점

## 보고서 작성 가이드

### 발견사항 기록
- **취약점 분류**: OWASP Top 10 기준 분류
- **위험도**: 높음/중간/낮음 평가
- **영향 범위**: affected systems, data scope
- **재현 단계**: step-by-step reproduction
- **권장 조치**: remediation recommendations
- **참고 자료**: CVE, OWASP, vendor advisories

### 우선순위 제안
1. **즉시 조치**: 높음 위험도 취약점
2. **단기 개선**: 중간 위험도 취약점
3. **장기 계획**: 낮음 위험도 개선 사항
4. **모니터링**: 지속적인 관심이 필요한 항목